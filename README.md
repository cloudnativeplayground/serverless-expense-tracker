# Serverless Expense Tracker

**Serverless Expense Tracker** is an open-source project designed to help users track and manage their personal expenses using a cloud-native, serverless architecture. Built with **Java**, **Spring**, and **Kubernetes-based serverless frameworks**, this project leverages modern development practices for scalability and efficiency.

## Features
- **Serverless Architecture**: Uses Kubernetes-based serverless frameworks for efficient resource management.
- **Expense Tracking**: Track daily, monthly, and yearly expenses with detailed categorization.
- **Cloud-Native Design**: Fully containerized and orchestrated with Kubernetes.
- **MySQL Database**: Persistent storage using MySQL.
- **Open Source**: Licensed under GNU GPL v3.

## Tech Stack
- **Programming Language**: Java
- **Framework**: Spring Boot
- **Database**: MySQL
- **Architecture**: Serverless on Kubernetes
- **Orchestration**: Kubernetes

## Folder Structure
```
serverless-expense-tracker/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/cloudnativeplayground/expensetracker/
â”‚   â”‚   â”‚       â”œâ”€â”€ Handler.java                # Entry point for the Kubeless function
â”‚   â”‚   â”‚       â”œâ”€â”€ model/                      # Data models (e.g., Expense.java)
â”‚   â”‚   â”‚       â”œâ”€â”€ service/                    # Business logic (optional for complex functions)
â”‚   â”‚   â”‚       â””â”€â”€ repository/                 # Data persistence logic
â”‚   â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â”‚   â”œâ”€â”€ application.yml                 # Spring Boot configuration (MySQL connection)
â”‚   â”‚   â”‚   â””â”€â”€ db/migration/
â”‚   â”‚   â”‚       â””â”€â”€ V1__Initial_setup.sql       # Database migration script
â”‚   â”‚   â”œâ”€â”€ kubeless/
â”‚   â”‚       â”œâ”€â”€ kubeless-function.yaml          # Kubeless function definition
â”‚   â”‚       â”œâ”€â”€ http-trigger.yaml               # HTTP trigger for Kubeless function
â”‚   â”‚       â””â”€â”€ kafka-trigger.yaml              # Kafka trigger for event-driven use case
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/cloudnativeplayground/expensetracker/
â”‚   â”‚   â”‚       â””â”€â”€ HandlerTest.java            # Unit tests for the function
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ application-test.yml            # Test-specific configurations
â”œâ”€â”€ helm/
â”‚   â”œâ”€â”€ Chart.yaml                              # Metadata for the Helm chart
â”‚   â”œâ”€â”€ values.yaml                             # Default configuration values
â”‚   â””â”€â”€ templates/
â”‚       â”œâ”€â”€ deployment.yaml                     # Kubernetes Deployment for running as a pod
â”‚       â”œâ”€â”€ service.yaml                        # Kubernetes Service for networking
â”‚       â””â”€â”€ ingress.yaml                        # Kubernetes Ingress for external access
â”œâ”€â”€ target/                                     # Build artifacts (generated by Maven)
â”œâ”€â”€ Dockerfile                                  # Docker image definition
â”œâ”€â”€ pom.xml                                     # Maven configuration
â”œâ”€â”€ README.md                                   # Project documentation
â”œâ”€â”€ LICENSE                                     # GNU GPL v3 license
â””â”€â”€ .gitignore                                  # Files to ignore in version control
```

## File Descriptions
- **Handler.java**: The entry point for the serverless function.
- **kubeless-function.yaml**: Defines the function for Kubeless, including runtime and handler.
- **http-trigger.yaml**: Configures an HTTP trigger to expose the Kubeless function as an API.
- **kafka-trigger.yaml**: (Optional) Configures a Kafka trigger for event-driven use cases.
- **Chart.yaml**: Metadata for Helm chart deployment.
- **values.yaml**: Default Helm values for configuration.
- **deployment.yaml**: Kubernetes Deployment manifest for running the application as a pod.
- **service.yaml**: Kubernetes Service manifest for exposing the application within the cluster.
- **ingress.yaml**: Kubernetes Ingress manifest for external access.
- **Dockerfile**: Defines the Docker image for the application.
- **application.yml**: Configuration file for Spring Boot, including MySQL connection details.
- **pom.xml**: Maven dependencies and build configuration.

## Database Configuration (MySQL)
The application uses MySQL as the database. Update the `application.yml` file with your MySQL credentials:
```yaml
spring:
  datasource:
    url: jdbc:mysql://<MYSQL_HOST>:<MYSQL_PORT>/<DATABASE_NAME>
    username: <USERNAME>
    password: <PASSWORD>
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.MySQL8Dialect
```

Run the SQL migrations defined in `src/main/resources/db/migration` to initialize the database schema:
```sql
CREATE TABLE expense (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    date DATE NOT NULL,
    category VARCHAR(255)
);
```

## Getting Started

### Prerequisites
- **Java 17+**
- **Maven 3.8+**
- **Docker**
- **MySQL Database**
- **Kubernetes Cluster** (e.g., Minikube, Kind, or managed Kubernetes services like AKS, EKS, or GKE)
- **Kubeless CLI**

### Build and Package the Application
1. Clone the repository:
   ```bash
   git clone https://github.com/cloudnativeplayground/serverless-expense-tracker.git
   ```
2. Navigate to the project directory:
   ```bash
   cd serverless-expense-tracker
   ```
3. Build the project:
   ```bash
   mvn clean package
   ```
4. Build the Docker image:
   ```bash
   docker build -t expensetracker:latest .
   ```

## Deploying the Application

### Deploy as a Serverless Application (Kubeless)
1. Install Kubeless:
   ```bash
   kubectl create ns kubeless
   kubectl apply -f https://raw.githubusercontent.com/kubeless/kubeless/master/manifests/kubeless-non-rbac.yaml
   ```
2. Deploy the function:
   ```bash
   kubectl apply -f src/main/kubeless/kubeless-function.yaml
   ```
3. Create an HTTP trigger:
   ```bash
   kubectl apply -f src/main/kubeless/http-trigger.yaml
   ```
4. Test the function:
   ```bash
   curl http://<kubernetes-ip>:<nodeport>/expensetracker
   ```

### Deploy as a Kubernetes Pod (Helm)
1. Ensure Helm is installed:
   ```bash
   helm version
   ```
2. Deploy using Helm:
   ```bash
   helm install expensetracker ./helm
   ```
3. Verify the deployment:
   ```bash
   kubectl get pods
   kubectl get services
   ```
4. Access the application via Ingress or Service:
   ```bash
   kubectl port-forward svc/expensetracker 8080:80
   ```
   Visit: [http://localhost:8080](http://localhost:8080)

## Testing the Application
1. **Database Initialization**:
   Ensure MySQL is running and has the correct schema.
   ```bash
   docker exec -it mysql-expensetracker mysql -u root -p
   ```
2. **Run Tests**:
   Execute unit tests:
   ```bash
   mvn test
   ```
3. **Manual Testing**:
   Use Postman or curl to test API endpoints.

## Contribution
Contributions are welcome! If you want to contribute:
1. Fork the repository.
2. Create a new branch for your feature or bug fix.
3. Submit a pull request with detailed information.

## Maintainer
This project is maintained by **[Aditya Pratap Bhuyan](https://linkedin.com/in/adityabhuyan)**.

## License
This project is licensed under the **GNU General Public License v3 (GPLv3)**.

---

Happy coding with **Serverless Expense Tracker**! ðŸš€
